#!/bin/bash

set -ex

# Remove old compiled bytecode files
#
find . | grep -E "(__pycache__|\.pyc|\.pyo$)" | xargs rm -rf

# Make the directory into which XML format test reports will be saved
#
mkdir -p test-reports

# Make the directory into which coverage reports will be saved
#
mkdir -p coverage

# Run the test Docker image as a container
#
docker run --platform linux/amd64 --rm \
	-v $(pwd)/test-reports:/home/tests/reports \
	-v $(pwd)/coverage:/home/tests/coverage \
	sds/maskfill-test "${@:2}"
